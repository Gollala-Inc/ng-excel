import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "@angular/cdk/scrolling";
import * as i2 from "@angular/common";
export class ExcelViewerComponent {
    constructor() {
        this.selectMode = false;
        this.selected = new EventEmitter();
        this.unSelected = new EventEmitter();
        this.current = 0;
        this.defaultHeight = 25;
        this.fixedColumnWidth = 45;
        this.rowWidth = 0;
        this.itemSize = 15;
        this.virtualImageOffset = 0;
    }
    set setWorkBook(excelData) {
        this.excelData = excelData;
        console.log(excelData);
        if (this.selectMode && this.excelData) {
            this.excelData.forEach(sheet => {
                sheet.rows.forEach(row => {
                    row.cells.forEach(cell => {
                        if (cell.merge) {
                            cell.cellStyle.height = cell.s_height + 'px';
                        }
                    });
                });
            });
        }
        setTimeout(() => {
            this.updateRowWidth();
        });
    }
    ngOnInit() {
    }
    getRowStyle(rowType, row) {
        if (!this.excelData) {
            return {};
        }
        const sheet = this.excelData[this.current];
        let height = 0;
        const rows = sheet.rows;
        if (rowType === 'header' || !rows[row || 0]['height']) {
            height = this.defaultHeight;
        }
        else {
            height = rows[row || 0]['height'];
        }
        return {
            width: `${this.rowWidth}px`,
            height: `${this.selectMode ? '30' : height}px`,
        };
    }
    updateRowWidth() {
        if (!this.excelData || !this.excelData[this.current] || !this.scrollViewport) {
            return;
        }
        let width = this.fixedColumnWidth;
        const cols = this.excelData[this.current].cols;
        for (let c = 0; c < cols.length; c++) {
            width += cols[c].width ? cols[c].width + 1 : 100;
        }
        this.rowWidth = width;
    }
    selectSheet(index) {
        this.current = index;
        this.updateRowWidth();
    }
    hasScrollForSheets() {
        if (!this.sheetNamesRef) {
            return false;
        }
        return this.sheetNamesRef.nativeElement.scrollWidth > this.sheetNamesRef.nativeElement.offsetWidth;
    }
    onScrollGrid(event) {
        // virtual image offset
        if (!this.scrollViewport || !this.excelData || !this.gridHeaderRef || !this.gridFixedHeaderRef) {
            return;
        }
        const offset = this.scrollViewport['_renderedContentOffset'] || 0;
        const index = Math.round(offset / this.itemSize);
        if (!index) {
            this.virtualImageOffset = 0;
        }
        else {
            let rowHeight = 0;
            for (let i = 0; i < index; i++) {
                const os = this.itemSize - this.excelData[this.current].rows[i].height;
                rowHeight += os;
            }
            this.virtualImageOffset = rowHeight - offset;
        }
        // scroll left
        const scrollLeft = event.target.scrollLeft;
        if (!scrollLeft) {
            this.gridHeaderRef.nativeElement.style.transform = `translateX(0px)`;
            this.gridFixedHeaderRef.nativeElement.style.transform = `translateX(0px)`;
            return;
        }
        this.gridHeaderRef.nativeElement.style.transform = `translateX(-${scrollLeft}px)`;
        this.gridFixedHeaderRef.nativeElement.style.transform = `translateX(${scrollLeft}px)`;
    }
    onClickRow(row) {
        if (!this.selectMode || !this.excelData) {
            return;
        }
        const selected = row.selected;
        this.excelData[this.current].rows.forEach(row => {
            row.selected = false;
        });
        row.selected = !selected;
        if (row.selected) {
            this.selected.next(row);
        }
        else {
            this.unSelected.next(row);
        }
    }
}
ExcelViewerComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: ExcelViewerComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
ExcelViewerComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: ExcelViewerComponent, selector: "ng-excel-viewer", inputs: { selectMode: "selectMode", setWorkBook: ["excelData", "setWorkBook"] }, outputs: { selected: "selected", unSelected: "unSelected" }, viewQueries: [{ propertyName: "gridHeaderRef", first: true, predicate: ["gridHeader"], descendants: true }, { propertyName: "gridFixedHeaderRef", first: true, predicate: ["gridFixedHeader"], descendants: true }, { propertyName: "scrollViewport", first: true, predicate: ["scrollViewport"], descendants: true }, { propertyName: "sheetNamesRef", first: true, predicate: ["sheetNames"], descendants: true }], ngImport: i0, template: "<div class=\"component-wrap\" [ngClass]=\"{'select-mode': selectMode}\" *ngIf=\"excelData && excelData[current]\">\r\n  <div class=\"grid-header\">\r\n    <div class=\"row\" #gridHeader [ngStyle]=\"getRowStyle('header')\">\r\n      <div class=\"cell fixed\" #gridFixedHeader></div>\r\n      <div class=\"cell\" *ngFor=\"let col of excelData[current].cols\" [style.width.px]=\"col.width\">\r\n        {{col.name}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"grid-body\" [ngClass]=\"{'withScroll': hasScrollForSheets()}\">\r\n    <cdk-virtual-scroll-viewport class=\"grid-body-viewport\"\r\n                                 [itemSize]=\"itemSize\" [minBufferPx]=\"500\" [maxBufferPx]=\"500\"\r\n                                 (scroll)=\"onScrollGrid($event)\"\r\n                                 #scrollViewport>\r\n      <!--\uD604\uC7AC \uC0C1\uD669\uC5D0\uC11C \uC774\uBBF8\uC9C0 \uACE0\uB824 \uC548\uD568, \uB2E4\uC74C\uC73C\uB85C -->\r\n      <!--<div class=\"img-wrap\" [style.transform]=\"'translate(45px, ' + virtualImageOffset + 'px)'\">\r\n        <div class=\"image\" *ngFor=\"let img of excelData[current].images\" [ngStyle]=\"img.styleExpression\">\r\n          <img [src]=\"'data:image/png;base64,' + img.image\">\r\n        </div>\r\n      </div>-->\r\n      <ng-container *cdkVirtualFor=\"let row of excelData[current].rows; let r = index; templateCacheSize: 0;\">\r\n        <div *ngIf=\"!row.hidden\" class=\"row\" [ngStyle]=\"getRowStyle('data', r || 0)\" (click)=\"onClickRow(row)\">\r\n          <div class=\"hover-border\" [ngClass]=\"{'active': row.selected}\">\r\n            <div class=\"selected\">\r\n              <svg width=\"13\" height=\"10\" viewBox=\"0 0 13 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path d=\"M11.8899 1.13993C11.7947 1.04768 11.6674 0.996094 11.5349 0.996094C11.4024 0.996094 11.2751 1.04768 11.1799 1.13993L5.87988 6.48993C5.8334 6.5368 5.77815 6.57399 5.71722 6.59938C5.65629 6.62476 5.59091 6.63783 5.5249 6.63783C5.4589 6.63783 5.39357 6.62476 5.33264 6.59938C5.27171 6.57399 5.2164 6.5368 5.16992 6.48993L2.54993 3.84993C2.50345 3.80307 2.44814 3.76587 2.38721 3.74049C2.32628 3.7151 2.26089 3.70203 2.19489 3.70203C2.12888 3.70203 2.06355 3.7151 2.00262 3.74049C1.94169 3.76587 1.88639 3.80307 1.8399 3.84993L1.13989 4.54993C1.04764 4.64508 0.996094 4.7724 0.996094 4.90493C0.996094 5.03746 1.04764 5.16478 1.13989 5.25993L5.13989 9.31993C5.23504 9.41218 5.36241 9.46377 5.49493 9.46377C5.62746 9.46377 5.75476 9.41218 5.84991 9.31993L12.5599 2.54993C12.6515 2.45647 12.7028 2.33081 12.7028 2.19993C12.7028 2.06905 12.6515 1.9434 12.5599 1.84993L11.8899 1.13993Z\" fill=\"white\"/>\r\n              </svg>\r\n            </div>\r\n          </div>\r\n          <div class=\"cell fixed\">\r\n            <div class=\"cell-item\" [innerHTML]=\"(r + 1)\"></div>\r\n          </div>\r\n          <div class=\"cell\" *ngFor=\"let cell of row.cells; let c = index\"\r\n               [style.width.px]=\"excelData[current].cols[c]?.width || 0\">\r\n            <div class=\"cell-item\" [innerHTML]=\"cell.cellValue\" [ngStyle]=\"cell.cellStyle\"></div>\r\n          </div>\r\n        </div>\r\n      </ng-container>\r\n    </cdk-virtual-scroll-viewport>\r\n  </div>\r\n  <div class=\"grid-footer\" *ngIf=\"!selectMode\">\r\n    <ul class=\"sheets\" #sheetNames>\r\n      <li *ngFor=\"let sheet of excelData; let i = index\" [ngClass]=\"i === current ? 'selected' : ''\" (click)=\"selectSheet(i)\">\r\n        {{ sheet.name }}\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n</div>\r\n<table >\r\n\r\n</table>\r\n", styles: [":host{height:100%;width:-moz-fit-content;width:fit-content;display:inline-block}.component-wrap{height:100%;overflow:hidden;display:flex;flex-direction:column}.component-wrap.select-mode{max-width:1032px;height:305px;padding-left:40px;padding-right:2px;max-height:100%}.component-wrap.select-mode cdk-virtual-scroll-viewport{overflow:visible;contain:initial;z-index:11}.component-wrap.select-mode cdk-virtual-scroll-viewport ::ng-deep .cdk-virtual-scroll-content-wrapper{contain:inherit}.component-wrap.select-mode .grid-body .row{position:relative}.component-wrap.select-mode .grid-body .row:hover .hover-border{display:block;cursor:pointer}.component-wrap.select-mode .grid-body .row .hover-border{display:none;position:absolute;left:-2px;top:-2px;width:100%;height:100%;border:2px solid #EE2554;max-width:1032px;z-index:11;border-radius:4px}.component-wrap.select-mode .grid-body .row .hover-border.active{display:block;background:#ee25541a}.component-wrap.select-mode .grid-body .row .hover-border.active .selected{display:flex}.component-wrap.select-mode .grid-body .row .hover-border .selected{position:absolute;width:24px;height:24px;left:-40px;top:3px;border:1px solid #CC1F46;box-sizing:border-box;border-radius:12px;background:#EE2554;display:none;align-items:center;justify-content:center}.component-wrap .row{display:inline-block;border-bottom:1px solid #ddd}.component-wrap .row .hover-border{display:none}.component-wrap .row .cell{position:relative;height:100%;display:inline-block}.component-wrap .row .cell.fixed{width:45px;position:sticky;left:0;float:left;z-index:10}.component-wrap .row .cell.fixed .cell-item{display:flex;align-items:center;justify-content:center;background:#f6f6f6;font-size:13px}.component-wrap .row .cell .cell-item{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;padding:3px;box-sizing:border-box}.component-wrap .row .cell+.cell{border-left:1px solid #eee}.component-wrap .grid-header{justify-content:center;overflow:hidden;height:25px}.component-wrap .grid-header .row{color:#757575;height:24px!important}.component-wrap .grid-header .row .fixed{background:#f6f6f6}.component-wrap .grid-header .row .cell{white-space:nowrap;text-align:center;background:#f6f6f6;font-size:13px;line-height:25px;border-bottom:1px solid #ddd}.component-wrap .grid-body{height:calc(100% - 50px);flex:1}.component-wrap .grid-body .grid-body-viewport{height:100%}.component-wrap .grid-body .grid-body-viewport .no-order{background-color:#ff5d5d!important;color:#fff}.component-wrap .grid-body .grid-body-viewport .no-order:hover{background-color:#ff2f2a!important}.component-wrap .grid-body .grid-body-viewport ::ng-deep .cdk-virtual-scroll-content-wrapper{display:inline-grid}.component-wrap .grid-body .img-wrap{position:relative;transform:translate(45px);z-index:10}.component-wrap .grid-body .img-wrap .image{position:absolute;z-index:50}.component-wrap .grid-body .img-wrap .image img{width:100%;height:100%}.component-wrap .grid-body.withScroll{height:calc(100% - 65px)}.component-wrap .grid-footer{height:25px;background-color:#eee}.component-wrap .grid-footer .sheets{margin:0;list-style:none;padding:0 0 0 30px;white-space:nowrap;overflow-x:scroll}.component-wrap .grid-footer .sheets>li{display:inline-block;padding:3px 15px;border-right:solid 1px #ddd;font-size:12px;cursor:pointer}.component-wrap .grid-footer .sheets>li:first-child{border-left:solid 1px #ddd}.component-wrap .grid-footer .sheets>li.selected{border-bottom:solid 3px #1f6e39;background-color:#fff;cursor:default}\n"], components: [{ type: i1.CdkVirtualScrollViewport, selector: "cdk-virtual-scroll-viewport", inputs: ["orientation", "appendOnly"], outputs: ["scrolledIndexChange"] }], directives: [{ type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i2.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i2.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { type: i2.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i1.CdkFixedSizeVirtualScroll, selector: "cdk-virtual-scroll-viewport[itemSize]", inputs: ["itemSize", "minBufferPx", "maxBufferPx"] }, { type: i1.CdkVirtualForOf, selector: "[cdkVirtualFor][cdkVirtualForOf]", inputs: ["cdkVirtualForOf", "cdkVirtualForTrackBy", "cdkVirtualForTemplate", "cdkVirtualForTemplateCacheSize"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: ExcelViewerComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ng-excel-viewer', template: "<div class=\"component-wrap\" [ngClass]=\"{'select-mode': selectMode}\" *ngIf=\"excelData && excelData[current]\">\r\n  <div class=\"grid-header\">\r\n    <div class=\"row\" #gridHeader [ngStyle]=\"getRowStyle('header')\">\r\n      <div class=\"cell fixed\" #gridFixedHeader></div>\r\n      <div class=\"cell\" *ngFor=\"let col of excelData[current].cols\" [style.width.px]=\"col.width\">\r\n        {{col.name}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"grid-body\" [ngClass]=\"{'withScroll': hasScrollForSheets()}\">\r\n    <cdk-virtual-scroll-viewport class=\"grid-body-viewport\"\r\n                                 [itemSize]=\"itemSize\" [minBufferPx]=\"500\" [maxBufferPx]=\"500\"\r\n                                 (scroll)=\"onScrollGrid($event)\"\r\n                                 #scrollViewport>\r\n      <!--\uD604\uC7AC \uC0C1\uD669\uC5D0\uC11C \uC774\uBBF8\uC9C0 \uACE0\uB824 \uC548\uD568, \uB2E4\uC74C\uC73C\uB85C -->\r\n      <!--<div class=\"img-wrap\" [style.transform]=\"'translate(45px, ' + virtualImageOffset + 'px)'\">\r\n        <div class=\"image\" *ngFor=\"let img of excelData[current].images\" [ngStyle]=\"img.styleExpression\">\r\n          <img [src]=\"'data:image/png;base64,' + img.image\">\r\n        </div>\r\n      </div>-->\r\n      <ng-container *cdkVirtualFor=\"let row of excelData[current].rows; let r = index; templateCacheSize: 0;\">\r\n        <div *ngIf=\"!row.hidden\" class=\"row\" [ngStyle]=\"getRowStyle('data', r || 0)\" (click)=\"onClickRow(row)\">\r\n          <div class=\"hover-border\" [ngClass]=\"{'active': row.selected}\">\r\n            <div class=\"selected\">\r\n              <svg width=\"13\" height=\"10\" viewBox=\"0 0 13 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path d=\"M11.8899 1.13993C11.7947 1.04768 11.6674 0.996094 11.5349 0.996094C11.4024 0.996094 11.2751 1.04768 11.1799 1.13993L5.87988 6.48993C5.8334 6.5368 5.77815 6.57399 5.71722 6.59938C5.65629 6.62476 5.59091 6.63783 5.5249 6.63783C5.4589 6.63783 5.39357 6.62476 5.33264 6.59938C5.27171 6.57399 5.2164 6.5368 5.16992 6.48993L2.54993 3.84993C2.50345 3.80307 2.44814 3.76587 2.38721 3.74049C2.32628 3.7151 2.26089 3.70203 2.19489 3.70203C2.12888 3.70203 2.06355 3.7151 2.00262 3.74049C1.94169 3.76587 1.88639 3.80307 1.8399 3.84993L1.13989 4.54993C1.04764 4.64508 0.996094 4.7724 0.996094 4.90493C0.996094 5.03746 1.04764 5.16478 1.13989 5.25993L5.13989 9.31993C5.23504 9.41218 5.36241 9.46377 5.49493 9.46377C5.62746 9.46377 5.75476 9.41218 5.84991 9.31993L12.5599 2.54993C12.6515 2.45647 12.7028 2.33081 12.7028 2.19993C12.7028 2.06905 12.6515 1.9434 12.5599 1.84993L11.8899 1.13993Z\" fill=\"white\"/>\r\n              </svg>\r\n            </div>\r\n          </div>\r\n          <div class=\"cell fixed\">\r\n            <div class=\"cell-item\" [innerHTML]=\"(r + 1)\"></div>\r\n          </div>\r\n          <div class=\"cell\" *ngFor=\"let cell of row.cells; let c = index\"\r\n               [style.width.px]=\"excelData[current].cols[c]?.width || 0\">\r\n            <div class=\"cell-item\" [innerHTML]=\"cell.cellValue\" [ngStyle]=\"cell.cellStyle\"></div>\r\n          </div>\r\n        </div>\r\n      </ng-container>\r\n    </cdk-virtual-scroll-viewport>\r\n  </div>\r\n  <div class=\"grid-footer\" *ngIf=\"!selectMode\">\r\n    <ul class=\"sheets\" #sheetNames>\r\n      <li *ngFor=\"let sheet of excelData; let i = index\" [ngClass]=\"i === current ? 'selected' : ''\" (click)=\"selectSheet(i)\">\r\n        {{ sheet.name }}\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n</div>\r\n<table >\r\n\r\n</table>\r\n", styles: [":host{height:100%;width:-moz-fit-content;width:fit-content;display:inline-block}.component-wrap{height:100%;overflow:hidden;display:flex;flex-direction:column}.component-wrap.select-mode{max-width:1032px;height:305px;padding-left:40px;padding-right:2px;max-height:100%}.component-wrap.select-mode cdk-virtual-scroll-viewport{overflow:visible;contain:initial;z-index:11}.component-wrap.select-mode cdk-virtual-scroll-viewport ::ng-deep .cdk-virtual-scroll-content-wrapper{contain:inherit}.component-wrap.select-mode .grid-body .row{position:relative}.component-wrap.select-mode .grid-body .row:hover .hover-border{display:block;cursor:pointer}.component-wrap.select-mode .grid-body .row .hover-border{display:none;position:absolute;left:-2px;top:-2px;width:100%;height:100%;border:2px solid #EE2554;max-width:1032px;z-index:11;border-radius:4px}.component-wrap.select-mode .grid-body .row .hover-border.active{display:block;background:#ee25541a}.component-wrap.select-mode .grid-body .row .hover-border.active .selected{display:flex}.component-wrap.select-mode .grid-body .row .hover-border .selected{position:absolute;width:24px;height:24px;left:-40px;top:3px;border:1px solid #CC1F46;box-sizing:border-box;border-radius:12px;background:#EE2554;display:none;align-items:center;justify-content:center}.component-wrap .row{display:inline-block;border-bottom:1px solid #ddd}.component-wrap .row .hover-border{display:none}.component-wrap .row .cell{position:relative;height:100%;display:inline-block}.component-wrap .row .cell.fixed{width:45px;position:sticky;left:0;float:left;z-index:10}.component-wrap .row .cell.fixed .cell-item{display:flex;align-items:center;justify-content:center;background:#f6f6f6;font-size:13px}.component-wrap .row .cell .cell-item{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;padding:3px;box-sizing:border-box}.component-wrap .row .cell+.cell{border-left:1px solid #eee}.component-wrap .grid-header{justify-content:center;overflow:hidden;height:25px}.component-wrap .grid-header .row{color:#757575;height:24px!important}.component-wrap .grid-header .row .fixed{background:#f6f6f6}.component-wrap .grid-header .row .cell{white-space:nowrap;text-align:center;background:#f6f6f6;font-size:13px;line-height:25px;border-bottom:1px solid #ddd}.component-wrap .grid-body{height:calc(100% - 50px);flex:1}.component-wrap .grid-body .grid-body-viewport{height:100%}.component-wrap .grid-body .grid-body-viewport .no-order{background-color:#ff5d5d!important;color:#fff}.component-wrap .grid-body .grid-body-viewport .no-order:hover{background-color:#ff2f2a!important}.component-wrap .grid-body .grid-body-viewport ::ng-deep .cdk-virtual-scroll-content-wrapper{display:inline-grid}.component-wrap .grid-body .img-wrap{position:relative;transform:translate(45px);z-index:10}.component-wrap .grid-body .img-wrap .image{position:absolute;z-index:50}.component-wrap .grid-body .img-wrap .image img{width:100%;height:100%}.component-wrap .grid-body.withScroll{height:calc(100% - 65px)}.component-wrap .grid-footer{height:25px;background-color:#eee}.component-wrap .grid-footer .sheets{margin:0;list-style:none;padding:0 0 0 30px;white-space:nowrap;overflow-x:scroll}.component-wrap .grid-footer .sheets>li{display:inline-block;padding:3px 15px;border-right:solid 1px #ddd;font-size:12px;cursor:pointer}.component-wrap .grid-footer .sheets>li:first-child{border-left:solid 1px #ddd}.component-wrap .grid-footer .sheets>li.selected{border-bottom:solid 3px #1f6e39;background-color:#fff;cursor:default}\n"] }]
        }], ctorParameters: function () { return []; }, propDecorators: { gridHeaderRef: [{
                type: ViewChild,
                args: ['gridHeader']
            }], gridFixedHeaderRef: [{
                type: ViewChild,
                args: ['gridFixedHeader']
            }], scrollViewport: [{
                type: ViewChild,
                args: ['scrollViewport']
            }], sheetNamesRef: [{
                type: ViewChild,
                args: ['sheetNames']
            }], selectMode: [{
                type: Input,
                args: ['selectMode']
            }], selected: [{
                type: Output,
                args: ['selected']
            }], unSelected: [{
                type: Output,
                args: ['unSelected']
            }], setWorkBook: [{
                type: Input,
                args: ['excelData']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhjZWwtdmlld2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25nLWV4Y2VsL3NyYy9saWIvY29tcG9uZW50L2V4Y2VsLXZpZXdlci9leGNlbC12aWV3ZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmctZXhjZWwvc3JjL2xpYi9jb21wb25lbnQvZXhjZWwtdmlld2VyL2V4Y2VsLXZpZXdlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFjLFlBQVksRUFBRSxLQUFLLEVBQVUsTUFBTSxFQUFFLFNBQVMsRUFBQyxNQUFNLGVBQWUsQ0FBQzs7OztBQVVwRyxNQUFNLE9BQU8sb0JBQW9CO0lBa0QvQjtRQXBDcUIsZUFBVSxHQUFZLEtBQUssQ0FBQztRQUM3QixhQUFRLEdBQTJCLElBQUksWUFBWSxFQUFZLENBQUM7UUFDOUQsZUFBVSxHQUEyQixJQUFJLFlBQVksRUFBWSxDQUFDO1FBeUJ4RixZQUFPLEdBQUcsQ0FBQyxDQUFDO1FBRVosa0JBQWEsR0FBRyxFQUFFLENBQUM7UUFDbkIscUJBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLGFBQVEsR0FBRyxDQUFDLENBQUM7UUFFYixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBQ2QsdUJBQWtCLEdBQUcsQ0FBQyxDQUFDO0lBRVAsQ0FBQztJQTlCakIsSUFDSSxXQUFXLENBQUMsU0FBbUM7UUFDakQsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN2QixJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNyQyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtnQkFDN0IsS0FBSyxDQUFDLElB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QkFDSSxVQUFVO3NCQUEvQixNQUFNO3VCQUFDLFlBQVk7Z0JBS2hCLFdBQVc7c0JBRGQsS0FBSzt1QkFBQyxXQUFXIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBWaWV3Q2hpbGR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge0V4Y2VsU2hlZXR9IGZyb20gJy4uLy4uL2NsYXNzL2V4Y2VsLXNoZWV0JztcclxuaW1wb3J0IHtDZGtWaXJ0dWFsU2Nyb2xsVmlld3BvcnR9IGZyb20gJ0Bhbmd1bGFyL2Nkay9zY3JvbGxpbmcnO1xyXG5pbXBvcnQge0V4Y2VsUm93fSBmcm9tIFwiLi4vLi4vY2xhc3MvZXhjZWwtcm93XCI7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ25nLWV4Y2VsLXZpZXdlcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2V4Y2VsLXZpZXdlci5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vZXhjZWwtdmlld2VyLmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIEV4Y2VsVmlld2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQFZpZXdDaGlsZCgnZ3JpZEhlYWRlcicpXHJcbiAgZ3JpZEhlYWRlclJlZjogRWxlbWVudFJlZiB8IHVuZGVmaW5lZDtcclxuXHJcbiAgQFZpZXdDaGlsZCgnZ3JpZEZpeGVkSGVhZGVyJylcclxuICBncmlkRml4ZWRIZWFkZXJSZWY6IEVsZW1lbnRSZWYgfCB1bmRlZmluZWQ7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ3Njcm9sbFZpZXdwb3J0JylcclxuICBzY3JvbGxWaWV3cG9ydDogQ2RrVmlydHVhbFNjcm9sbFZpZXdwb3J0IHwgdW5kZWZpbmVkO1xyXG5cclxuICBAVmlld0NoaWxkKCdzaGVldE5hbWVzJylcclxuICBzaGVldE5hbWVzUmVmOiBFbGVtZW50UmVmIHwgdW5kZWZpbmVkO1xyXG5cclxuICBASW5wdXQoJ3NlbGVjdE1vZGUnKSBzZWxlY3RNb2RlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgQE91dHB1dCgnc2VsZWN0ZWQnKSBzZWxlY3RlZDogRXZlbnRFbWl0dGVyPEV4Y2VsUm93PiA9IG5ldyBFdmVudEVtaXR0ZXI8RXhjZWxSb3c+KCk7XHJcbiAgQE91dHB1dCgndW5TZWxlY3RlZCcpIHVuU2VsZWN0ZWQ6IEV2ZW50RW1pdHRlcjxFeGNlbFJvdz4gPSBuZXcgRXZlbnRFbWl0dGVyPEV4Y2VsUm93PigpO1xyXG5cclxuXHJcbiAgZXhjZWxEYXRhOiBFeGNlbFNoZWV0W10gfCB1bmRlZmluZWRcclxuICBASW5wdXQoJ2V4Y2VsRGF0YScpXHJcbiAgc2V0IHNldFdvcmtCb29rKGV4Y2VsRGF0YTogRXhjZWxTaGVldFtdIHwgdW5kZWZpbmVkKSB7XHJcbiAgICB0aGlzLmV4Y2VsRGF0YSA9IGV4Y2VsRGF0YTtcclxuICAgIGNvbnNvbGUubG9nKGV4Y2VsRGF0YSk7XHJcbiAgICBpZiAodGhpcy5zZWxlY3RNb2RlICYmIHRoaXMuZXhjZWxEYXRhKSB7XHJcbiAgICAgIHRoaXMuZXhjZWxEYXRhLmZvckVhY2goc2hlZXQgPT4ge1xyXG4gICAgICAgIHNoZWV0LnJvd3MuZm9yRWFjaChyb3cgPT4ge1xyXG4gICAgICAgICAgcm93LmNlbGxzLmZvckVhY2goY2VsbCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjZWxsLm1lcmdlKSB7XHJcbiAgICAgICAgICAgICAgY2VsbC5jZWxsU3R5bGUuaGVpZ2h0ID0gY2VsbC5zX2hlaWdodCArICdweCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy51cGRhdGVSb3dXaWR0aCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjdXJyZW50ID0gMDtcclxuXHJcbiAgZGVmYXVsdEhlaWdodCA9IDI1O1xyXG4gIGZpeGVkQ29sdW1uV2lkdGggPSA0NTtcclxuICByb3dXaWR0aCA9IDA7XHJcblxyXG4gIGl0ZW1TaXplID0gMTU7XHJcbiAgdmlydHVhbEltYWdlT2Zmc2V0ID0gMDtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgfVxyXG5cclxuICBnZXRSb3dTdHlsZShyb3dUeXBlOiBzdHJpbmcsIHJvdz86IG51bWJlcikge1xyXG4gICAgaWYgKCF0aGlzLmV4Y2VsRGF0YSkge1xyXG4gICAgICByZXR1cm4ge307XHJcbiAgICB9XHJcbiAgICBjb25zdCBzaGVldCA9IHRoaXMuZXhjZWxEYXRhW3RoaXMuY3VycmVudF07XHJcblxyXG4gICAgbGV0IGhlaWdodDogbnVtYmVyID0gMDtcclxuICAgIGNvbnN0IHJvd3MgPSBzaGVldC5yb3dzO1xyXG5cclxuICAgIGlmIChyb3dUeXBlID09PSAnaGVhZGVyJyB8fCAhcm93c1tyb3cgfHwgMF1bJ2hlaWdodCddKSB7XHJcbiAgICAgIGhlaWdodCA9IHRoaXMuZGVmYXVsdEhlaWdodDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBoZWlnaHQgPSByb3dzW3JvdyB8fCAwXVsnaGVpZ2h0J107XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgd2lkdGg6IGAke3RoaXMucm93V2lkdGh9cHhgLFxyXG4gICAgICBoZWlnaHQ6IGAke3RoaXMuc2VsZWN0TW9kZSA/ICczMCcgOiBoZWlnaHR9cHhgLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVJvd1dpZHRoKCkge1xyXG4gICAgaWYgKCF0aGlzLmV4Y2VsRGF0YSB8fCAhdGhpcy5leGNlbERhdGFbdGhpcy5jdXJyZW50XSB8fCAhdGhpcy5zY3JvbGxWaWV3cG9ydCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHdpZHRoID0gdGhpcy5maXhlZENvbHVtbldpZHRoO1xyXG4gICAgY29uc3QgY29scyA9IHRoaXMuZXhjZWxEYXRhW3RoaXMuY3VycmVudF0uY29scztcclxuXHJcbiAgICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbHMubGVuZ3RoOyBjKyspIHtcclxuICAgICAgd2lkdGggKz0gY29sc1tjXS53aWR0aCA/IGNvbHNbY10ud2lkdGggKyAxIDogMTAwO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucm93V2lkdGggPSB3aWR0aDtcclxuICB9XHJcblxyXG4gIHNlbGVjdFNoZWV0KGluZGV4OiBudW1iZXIpIHtcclxuICAgIHRoaXMuY3VycmVudCA9IGluZGV4O1xyXG4gICAgdGhpcy51cGRhdGVSb3dXaWR0aCgpO1xyXG4gIH1cclxuXHJcbiAgaGFzU2Nyb2xsRm9yU2hlZXRzKCkge1xyXG4gICAgaWYgKCF0aGlzLnNoZWV0TmFtZXNSZWYpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLnNoZWV0TmFtZXNSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxXaWR0aCA+IHRoaXMuc2hlZXROYW1lc1JlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gIH1cclxuXHJcbiAgb25TY3JvbGxHcmlkKGV2ZW50OiBhbnkpIHtcclxuICAgIC8vIHZpcnR1YWwgaW1hZ2Ugb2Zmc2V0XHJcbiAgICBpZiAoIXRoaXMuc2Nyb2xsVmlld3BvcnQgfHwgIXRoaXMuZXhjZWxEYXRhIHx8ICF0aGlzLmdyaWRIZWFkZXJSZWYgfHwgIXRoaXMuZ3JpZEZpeGVkSGVhZGVyUmVmKSB7XHJcbiAgICAgIHJldHVybiA7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgb2Zmc2V0ID0gdGhpcy5zY3JvbGxWaWV3cG9ydFsnX3JlbmRlcmVkQ29udGVudE9mZnNldCddIHx8IDA7XHJcbiAgICBjb25zdCBpbmRleCA9IE1hdGgucm91bmQob2Zmc2V0IC8gdGhpcy5pdGVtU2l6ZSk7XHJcbiAgICBpZiAoIWluZGV4KSB7XHJcbiAgICAgIHRoaXMudmlydHVhbEltYWdlT2Zmc2V0ID0gMDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCByb3dIZWlnaHQgPSAwO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluZGV4OyBpKyspIHtcclxuICAgICAgICBjb25zdCBvcyA9IHRoaXMuaXRlbVNpemUgLSB0aGlzLmV4Y2VsRGF0YVt0aGlzLmN1cnJlbnRdLnJvd3NbaV0uaGVpZ2h0O1xyXG4gICAgICAgIHJvd0hlaWdodCArPSBvcztcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnZpcnR1YWxJbWFnZU9mZnNldCA9IHJvd0hlaWdodCAtIG9mZnNldDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBzY3JvbGwgbGVmdFxyXG4gICAgY29uc3Qgc2Nyb2xsTGVmdCA9IGV2ZW50LnRhcmdldC5zY3JvbGxMZWZ0O1xyXG5cclxuICAgIGlmICghc2Nyb2xsTGVmdCkge1xyXG4gICAgICB0aGlzLmdyaWRIZWFkZXJSZWYubmF0aXZlRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgwcHgpYDtcclxuICAgICAgdGhpcy5ncmlkRml4ZWRIZWFkZXJSZWYubmF0aXZlRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgwcHgpYDtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZ3JpZEhlYWRlclJlZi5uYXRpdmVFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3Njcm9sbExlZnR9cHgpYDtcclxuICAgIHRoaXMuZ3JpZEZpeGVkSGVhZGVyUmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHtzY3JvbGxMZWZ0fXB4KWA7XHJcbiAgfVxyXG5cclxuICBvbkNsaWNrUm93KHJvdzogRXhjZWxSb3cpIHtcclxuICAgIGlmICghdGhpcy5zZWxlY3RNb2RlIHx8ICF0aGlzLmV4Y2VsRGF0YSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBzZWxlY3RlZCA9IHJvdy5zZWxlY3RlZDtcclxuICAgIHRoaXMuZXhjZWxEYXRhW3RoaXMuY3VycmVudF0ucm93cy5mb3JFYWNoKHJvdyA9PiB7XHJcbiAgICAgIHJvdy5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgfSk7XHJcbiAgICByb3cuc2VsZWN0ZWQgPSAhc2VsZWN0ZWQ7XHJcbiAgICBpZiAocm93LnNlbGVjdGVkKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0ZWQubmV4dChyb3cpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy51blNlbGVjdGVkLm5leHQocm93KTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcbiIsIjxkaXYgY2xhc3M9XCJjb21wb25lbnQtd3JhcFwiIFtuZ0NsYXNzXT1cInsnc2VsZWN0LW1vZGUnOiBzZWxlY3RNb2RlfVwiICpuZ0lmPVwiZXhjZWxEYXRhICYmIGV4Y2VsRGF0YVtjdXJyZW50XVwiPlxyXG4gIDxkaXYgY2xhc3M9XCJncmlkLWhlYWRlclwiPlxyXG4gICAgPGRpdiBjbGFzcz1cInJvd1wiICNncmlkSGVhZGVyIFtuZ1N0eWxlXT1cImdldFJvd1N0eWxlKCdoZWFkZXInKVwiPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwiY2VsbCBmaXhlZFwiICNncmlkRml4ZWRIZWFkZXI+PC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3M9XCJjZWxsXCIgKm5nRm9yPVwibGV0IGNvbCBvZiBleGNlbERhdGFbY3VycmVudF0uY29sc1wiIFtzdHlsZS53aWR0aC5weF09XCJjb2wud2lkdGhcIj5cclxuICAgICAgICB7e2NvbC5uYW1lfX1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICA8L2Rpdj5cclxuICA8ZGl2IGNsYXNzPVwiZ3JpZC1ib2R5XCIgW25nQ2xhc3NdPVwieyd3aXRoU2Nyb2xsJzogaGFzU2Nyb2xsRm9yU2hlZXRzKCl9XCI+XHJcbiAgICA8Y2RrLXZpcnR1YWwtc2Nyb2xsLXZpZXdwb3J0IGNsYXNzPVwiZ3JpZC1ib2R5LXZpZXdwb3J0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2l0ZW1TaXplXT1cIml0ZW1TaXplXCIgW21pbkJ1ZmZlclB4XT1cIjUwMFwiIFttYXhCdWZmZXJQeF09XCI1MDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc2Nyb2xsKT1cIm9uU2Nyb2xsR3JpZCgkZXZlbnQpXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3Njcm9sbFZpZXdwb3J0PlxyXG4gICAgICA8IS0t7ZiE7J6sIOyDge2ZqeyXkOyEnCDsnbTrr7jsp4Ag6rOg66CkIOyViO2VqCwg64uk7J2M7Jy866GcIC0tPlxyXG4gICAgICA8IS0tPGRpdiBjbGFzcz1cImltZy13cmFwXCIgW3N0eWxlLnRyYW5zZm9ybV09XCIndHJhbnNsYXRlKDQ1cHgsICcgKyB2aXJ0dWFsSW1hZ2VPZmZzZXQgKyAncHgpJ1wiPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJpbWFnZVwiICpuZ0Zvcj1cImxldCBpbWcgb2YgZXhjZWxEYXRhW2N1cnJlbnRdLmltYWdlc1wiIFtuZ1N0eWxlXT1cImltZy5zdHlsZUV4cHJlc3Npb25cIj5cclxuICAgICAgICAgIDxpbWcgW3NyY109XCInZGF0YTppbWFnZS9wbmc7YmFzZTY0LCcgKyBpbWcuaW1hZ2VcIj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+LS0+XHJcbiAgICAgIDxuZy1jb250YWluZXIgKmNka1ZpcnR1YWxGb3I9XCJsZXQgcm93IG9mIGV4Y2VsRGF0YVtjdXJyZW50XS5yb3dzOyBsZXQgciA9IGluZGV4OyB0ZW1wbGF0ZUNhY2hlU2l6ZTogMDtcIj5cclxuICAgICAgICA8ZGl2ICpuZ0lmPVwiIXJvdy5oaWRkZW5cIiBjbGFzcz1cInJvd1wiIFtuZ1N0eWxlXT1cImdldFJvd1N0eWxlKCdkYXRhJywgciB8fCAwKVwiIChjbGljayk9XCJvbkNsaWNrUm93KHJvdylcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJob3Zlci1ib3JkZXJcIiBbbmdDbGFzc109XCJ7J2FjdGl2ZSc6IHJvdy5zZWxlY3RlZH1cIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNlbGVjdGVkXCI+XHJcbiAgICAgICAgICAgICAgPHN2ZyB3aWR0aD1cIjEzXCIgaGVpZ2h0PVwiMTBcIiB2aWV3Qm94PVwiMCAwIDEzIDEwXCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XHJcbiAgICAgICAgICAgICAgICA8cGF0aCBkPVwiTTExLjg4OTkgMS4xMzk5M0MxMS43OTQ3IDEuMDQ3NjggMTEuNjY3NCAwLjk5NjA5NCAxMS41MzQ5IDAuOTk2MDk0QzExLjQwMjQgMC45OTYwOTQgMTEuMjc1MSAxLjA0NzY4IDExLjE3OTkgMS4xMzk5M0w1Ljg3OTg4IDYuNDg5OTNDNS44MzM0IDYuNTM2OCA1Ljc3ODE1IDYuNTczOTkgNS43MTcyMiA2LjU5OTM4QzUuNjU2MjkgNi42MjQ3NiA1LjU5MDkxIDYuNjM3ODMgNS41MjQ5IDYuNjM3ODNDNS40NTg5IDYuNjM3ODMgNS4zOTM1NyA2LjYyNDc2IDUuMzMyNjQgNi41OTkzOEM1LjI3MTcxIDYuNTczOTkgNS4yMTY0IDYuNTM2OCA1LjE2OTkyIDYuNDg5OTNMMi41NDk5MyAzLjg0OTkzQzIuNTAzNDUgMy44MDMwNyAyLjQ0ODE0IDMuNzY1ODcgMi4zODcyMSAzLjc0MDQ5QzIuMzI2MjggMy43MTUxIDIuMjYwODkgMy43MDIwMyAyLjE5NDg5IDMuNzAyMDNDMi4xMjg4OCAzLjcwMjAzIDIuMDYzNTUgMy43MTUxIDIuMDAyNjIgMy43NDA0OUMxLjk0MTY5IDMuNzY1ODcgMS44ODYzOSAzLjgwMzA3IDEuODM5OSAzLjg0OTkzTDEuMTM5ODkgNC41NDk5M0MxLjA0NzY0IDQuNjQ1MDggMC45OTYwOTQgNC43NzI0IDAuOTk2MDk0IDQuOTA0OTNDMC45OTYwOTQgNS4wMzc0NiAxLjA0NzY0IDUuMTY0NzggMS4xMzk4OSA1LjI1OTkzTDUuMTM5ODkgOS4zMTk5M0M1LjIzNTA0IDkuNDEyMTggNS4zNjI0MSA5LjQ2Mzc3IDUuNDk0OTMgOS40NjM3N0M1LjYyNzQ2IDkuNDYzNzcgNS43NTQ3NiA5LjQxMjE4IDUuODQ5OTEgOS4zMTk5M0wxMi41NTk5IDIuNTQ5OTNDMTIuNjUxNSAyLjQ1NjQ3IDEyLjcwMjggMi4zMzA4MSAxMi43MDI4IDIuMTk5OTNDMTIuNzAyOCAyLjA2OTA1IDEyLjY1MTUgMS45NDM0IDEyLjU1OTkgMS44NDk5M0wxMS44ODk5IDEuMTM5OTNaXCIgZmlsbD1cIndoaXRlXCIvPlxyXG4gICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNlbGwgZml4ZWRcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNlbGwtaXRlbVwiIFtpbm5lckhUTUxdPVwiKHIgKyAxKVwiPjwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2VsbFwiICpuZ0Zvcj1cImxldCBjZWxsIG9mIHJvdy5jZWxsczsgbGV0IGMgPSBpbmRleFwiXHJcbiAgICAgICAgICAgICAgIFtzdHlsZS53aWR0aC5weF09XCJleGNlbERhdGFbY3VycmVudF0uY29sc1tjXT8ud2lkdGggfHwgMFwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2VsbC1pdGVtXCIgW2lubmVySFRNTF09XCJjZWxsLmNlbGxWYWx1ZVwiIFtuZ1N0eWxlXT1cImNlbGwuY2VsbFN0eWxlXCI+PC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICA8L2Nkay12aXJ0dWFsLXNjcm9sbC12aWV3cG9ydD5cclxuICA8L2Rpdj5cclxuICA8ZGl2IGNsYXNzPVwiZ3JpZC1mb290ZXJcIiAqbmdJZj1cIiFzZWxlY3RNb2RlXCI+XHJcbiAgICA8dWwgY2xhc3M9XCJzaGVldHNcIiAjc2hlZXROYW1lcz5cclxuICAgICAgPGxpICpuZ0Zvcj1cImxldCBzaGVldCBvZiBleGNlbERhdGE7IGxldCBpID0gaW5kZXhcIiBbbmdDbGFzc109XCJpID09PSBjdXJyZW50ID8gJ3NlbGVjdGVkJyA6ICcnXCIgKGNsaWNrKT1cInNlbGVjdFNoZWV0KGkpXCI+XHJcbiAgICAgICAge3sgc2hlZXQubmFtZSB9fVxyXG4gICAgICA8L2xpPlxyXG4gICAgPC91bD5cclxuICA8L2Rpdj5cclxuXHJcbjwvZGl2PlxyXG48dGFibGUgPlxyXG5cclxuPC90YWJsZT5cclxuIl19