const indexcedColors = {
    '0': '#FF000000',
    '1': '#FFFFFFFF',
    '2': '#FFFF0000',
    '3': '#FF00FF00',
    '4': '#FF0000FF',
    '5': '#FFFFFF00',
    '6': '#FFFF00FF',
    '7': '#FF00FFFF',
    '8': '#FF000000',
    '9': '#FFFFFFFF',
    '10': '#FFFF0000',
    '11': '#FF00FF00',
    '12': '#FF0000FF',
    '13': '#FFFFFF00',
    '14': '#FFFF00FF',
    '15': '#FF00FFFF',
    '16': '#FF800000',
    '17': '#FF008000',
    '18': '#FF000080',
    '19': '#FF808000',
    '20': '#FF800080',
    '21': '#FF008080',
    '22': '#FFC0C0C0',
    '23': '#FF808080',
    '24': '#FF9999FF',
    '25': '#FF993366',
    '26': '#FFFFFFCC',
    '27': '#FFCCFFFF',
    '28': '#FF660066',
    '29': '#FFFF8080',
    '30': '#FF0066CC',
    '31': '#FFCCCCFF',
    '32': '#FF000080',
    '33': '#FFFF00FF',
    '34': '#FFFFFF00',
    '35': '#FF00FFFF',
    '36': '#FF800080',
    '37': '#FF800000',
    '38': '#FF008080',
    '39': '#FF0000FF',
    '40': '#FF00CCFF',
    '41': '#FFCCFFFF',
    '42': '#FFCCFFCC',
    '43': '#FFFFFF99',
    '44': '#FF99CCFF',
    '45': '#FFFF99CC',
    '46': '#FFCC99FF',
    '47': '#FFFFCC99',
    '48': '#FF3366FF',
    '49': '#FF33CCCC',
    '50': '#FF99CC00',
    '51': '#FFFFCC00',
    '52': '#FFFF9900',
    '53': '#FFFF6600',
    '54': '#FF666699',
    '55': '#FF969696',
    '56': '#FF003366',
    '57': '#FF339966',
    '58': '#FF003300',
    '59': '#FF333300',
    '60': '#FF993300',
    '61': '#FF993366',
    '62': '#FF333399',
    '63': '#FF333333',
};
const themes = ['#FFFFFF', '#000000', '#E7E6E6', '#44546A', '#5B9BD5', '#ED7D31', '#A5A5A5', '#FFC000', '#4472C4', '#70AD47'];
export class ExcelCell {
    constructor(address, cellNumber, height, style, width, value, merge, s_height) {
        this.merge = false;
        this.address = address;
        this.cellNumber = cellNumber;
        this.height = height;
        this.style = style;
        this.width = width;
        this.value = value;
        this.merge = merge;
        this.s_height = s_height;
        this.getCellStyle();
        this.getCellValue();
    }
    getCellStyle() {
        const { style } = this;
        const result = {};
        if (style) {
            if (style.font?.size) {
                result['font-size'] = `${style.font.size}px`;
            }
            if (style.font?.bold) {
                result['font-weight'] = 'bold';
            }
            if (style.font?.color?.argb) {
                result['color'] = `#${style.font.color.argb.slice(-6)}`;
            }
            if (typeof this.value === 'number') {
                result['justify-content'] = 'flex-end';
            }
            if (style.alignment) {
                const alignment = {
                    middle: 'center',
                    center: 'center',
                    top: 'flex-start',
                    bottom: 'flex-end',
                    left: 'flex-start',
                    right: 'flex-end'
                };
                if (style.alignment.vertical) {
                    result['align-items'] = alignment[style.alignment.vertical];
                }
                if (style.alignment.horizontal) {
                    result['justify-content'] = alignment[style.alignment.horizontal];
                }
            }
            if (style.fill?.color?.indexed < 64) {
                const index = (style.fill?.color?.indexed || 0).toString();
                result['background'] = indexcedColors[index];
            }
            if (style.fill?.fgColor?.argb) {
                result['background'] = `#${style.fill.fgColor.argb.slice(-6)}`;
            }
            if (style.fill?.fgColor?.theme) {
                result['background'] = this.getTintColor(themes[style.fill.fgColor.theme], style.fill.fgColor.tint || 0);
            }
        }
        if (this.merge) {
            result['width'] = this.width + 'px';
            result['height'] = this.height + 'px' || '100%';
            result['z-index'] = 1;
            if (!result.background) {
                result['background'] = '#fff';
            }
        }
        this.cellStyle = result;
    }
    getCellValue() {
        if (typeof this.value === 'object' && this.value.richText) {
            return this.cellValue = this.value.richText.map((d) => d.text);
        }
        return this.cellValue = this.value;
    }
    getTintColor(hex, tint) {
        const shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
        hex = hex.replace(shorthandRegex, (m, r, g, b) => {
            return r + r + g + g + b + b;
        });
        const rgb = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        if (!rgb) {
            return null;
        }
        const r = parseInt(rgb[1], 16);
        const g = parseInt(rgb[2], 16);
        const b = parseInt(rgb[3], 16);
        if (tint >= 0) {
            return this.rgbToHex(r + ((255 - r) * tint), g + ((255 - g) * tint), b + ((255 - b) * tint));
        }
        else {
            return this.rgbToHex(r * (1 - (tint * -1)), g * (1 - (tint * -1)), b * (1 - (tint * -1)));
        }
    }
    rgbToHex(r, g, b) {
        return "#" + ((1 << 24) + (Math.round(r) << 16) + (Math.round(g) << 8) + Math.round(b)).toString(16).slice(1);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhjZWwtY2VsbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25nLWV4Y2VsL3NyYy9saWIvY2xhc3MvZXhjZWwtY2VsbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLGNBQWMsR0FBUTtJQUMxQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixHQUFHLEVBQUUsV0FBVztJQUNoQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUsV0FBVztJQUNqQixJQUFJLEVBQUUs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LENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzNGO0lBQ0gsQ0FBQztJQUVPLFFBQVEsQ0FBQyxDQUFRLEVBQUUsQ0FBUSxFQUFFLENBQVE7UUFDM0MsT0FBTyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2hILENBQUM7Q0FHRiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGluZGV4Y2VkQ29sb3JzOiBhbnkgPSB7XHJcbiAgJzAnOiAnI0ZGMDAwMDAwJyxcclxuICAnMSc6ICcjRkZGRkZGRkYnLFxyXG4gICcyJzogJyNGRkZGMDAwMCcsXHJcbiAgJzMnOiAnI0ZGMDBGRjAwJyxcclxuICAnNCc6ICcjRkYwMDAwRkYnLFxyXG4gICc1JzogJyNGRkZGRkYwMCcsXHJcbiAgJzYnOiAnI0ZGRkYwMEZGJyxcclxuICAnNyc6ICcjRkYwMEZGRkYnLFxyXG4gICc4JzogJyNGRjAwMDAwMCcsXHJcbiAgJzknOiAnI0ZGRkZGRkZGJyxcclxuICAnMTAnOiAnI0ZGRkYwMDAwJyxcclxuICAnMTEnOiAnI0ZGMDBGRjAwJyxcclxuICAnMTInOiAnI0ZGMDAwMEZGJyxcclxuICAnMTMnOiAnI0ZGRkZGRjAwJyxcclxuICAnMTQnOiAnI0ZGRkYwMEZGJyxcclxuICAnMTUnOiAnI0ZGMDBGRkZGJyxcclxuICAnMTYnOiAnI0ZGODAwMDAwJyxcclxuICAnMTcnOiAnI0ZGMDA4MDAwJyxcclxuICAnMTgnOiAnI0ZGMDAwMDgwJyxcclxuICAnMTknOiAnI0ZGODA4MDAwJyxcclxuICAnMjAnOiAnI0ZGODAwMDgwJyxcclxuICAnMjEnOiAnI0ZGMDA4MDgwJyxcclxuICAnMjInOiAnI0ZGQzBDMEMwJyxcclxuICAnMjMnOiAnI0ZGODA4MDgwJyxcclxuICAnMjQnOiAnI0ZGOTk5OUZGJyxcclxuICAnMjUnOiAnI0ZGOTkzMzY2JyxcclxuICAnMjYnOiAnI0ZGRkZGRkNDJyxcclxuICAnMjcnOiAnI0ZGQ0NGRkZGJyxcclxuICAnMjgnOiAnI0ZGNjYwMDY2JyxcclxuICAnMjknOiAnI0ZGRkY4MDgwJyxcclxuICAnMzAnOiAnI0ZGMDA2NkNDJyxcclxuICAnMzEnOiAnI0ZGQ0NDQ0ZGJyxcclxuICAnMzInOiAnI0ZGMDAwMDgwJyxcclxuICAnMzMnOiAnI0ZGRkYwMEZGJyxcclxuICAnMzQnOiAnI0ZGRkZGRjAwJyxcclxuICAnMzUnOiAnI0ZGMDBGRkZGJyxcclxuICAnMzYnOiAnI0ZGODAwMDgwJyxcclxuICAnMzcnOiAnI0ZGODAwMDAwJyxcclxuICAnMzgnOiAnI0ZGMDA4MDgwJyxcclxuICAnMzknOiAnI0ZGMDAwMEZGJyxcclxuICAnNDAnOiAnI0ZGMDBDQ0ZGJyxcclxuICAnNDEnOiAnI0ZGQ0NGRkZGJyxcclxuICAnNDInOiAnI0ZGQ0NGRkNDJyxcclxuICAnNDMnOiAnI0ZGRkZGRjk5JyxcclxuICAnNDQnOiAnI0ZGOTlDQ0ZGJyxcclxuICAnNDUnOiAnI0ZGRkY5OUNDJyxcclxuICAnNDYnOiAnI0ZGQ0M5OUZGJyxcclxuICAnNDcnOiAnI0ZGRkZDQzk5JyxcclxuICAnNDgnOiAnI0ZGMzM2NkZGJyxcclxuICAnNDknOiAnI0ZGMzNDQ0NDJyxcclxuICAnNTAnOiAnI0ZGOTlDQzAwJyxcclxuICAnNTEnOiAnI0ZGRkZDQzAwJyxcclxuICAnNTInOiAnI0ZGRkY5OTAwJyxcclxuICAnNTMnOiAnI0ZGRkY2NjAwJyxcclxuICAnNTQnOiAnI0ZGNjY2Njk5JyxcclxuICAnNTUnOiAnI0ZGOTY5Njk2JyxcclxuICAnNTYnOiAnI0ZGMDAzMzY2JyxcclxuICAnNTcnOiAnI0ZGMzM5OTY2JyxcclxuICAnNTgnOiAnI0ZGMDAzMzAwJyxcclxuICAnNTknOiAnI0ZGMzMzMzAwJyxcclxuICAnNjAnOiAnI0ZGOTkzMzAwJyxcclxuICAnNjEnOiAnI0ZGOTkzMzY2JyxcclxuICAnNjInOiAnI0ZGMzMzMzk5JyxcclxuICAnNjMnOiAnI0ZGMzMzMzMzJyxcclxufVxyXG5cclxuY29uc3QgdGhlbWVzID0gWycjRkZGRkZGJywgJyMwMDAwMDAnLCAnI0U3RTZFNicsICcjNDQ1NDZBJywgJyM1QjlCRDUnLCAnI0VEN0QzMScsICcjQTVBNUE1JywgJyNGRkMwMDAnLCAnIzQ0NzJDNCcsICcjNzBBRDQ3J107XHJcblxyXG5leHBvcnQgY2xhc3MgRXhjZWxDZWxse1xyXG5cclxuICBhZGRyZXNzOiBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgY2VsbE51bWJlcjogbnVtYmVyIHwgdW5kZWZpbmVkO1xyXG4gIGhlaWdodDogbnVtYmVyIHwgdW5kZWZpbmVkO1xyXG4gIHNfaGVpZ2h0OiBudW1iZXIgfCB1bmRlZmluZWQ7XHJcbiAgc3R5bGU6IGFueSB8IHVuZGVmaW5lZDtcclxuICB3aWR0aDogbnVtYmVyIHwgdW5kZWZpbmVkO1xyXG4gIHZhbHVlOiBhbnkgfCB1bmRlZmluZWQ7XHJcbiAgbWVyZ2U6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBjZWxsU3R5bGU6IGFueTtcclxuICBjZWxsVmFsdWU6IGFueSB8IHVuZGVmaW5lZDtcclxuXHJcblxyXG5cclxuXHJcbiAgY29uc3RydWN0b3IoYWRkcmVzczogc3RyaW5nIHwgdW5kZWZpbmVkLCBjZWxsTnVtYmVyOiBudW1iZXIgfCB1bmRlZmluZWQsIGhlaWdodDogbnVtYmVyIHwgdW5kZWZpbmVkLCBzdHlsZTogYW55IHwgdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICAgIHdpZHRoOiBudW1iZXIgfCB1bmRlZmluZWQsIHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQsIG1lcmdlOiBib29sZWFuLCBzX2hlaWdodDogbnVtYmVyIHwgdW5kZWZpbmVkKSB7XHJcbiAgICB0aGlzLmFkZHJlc3MgPSBhZGRyZXNzO1xyXG4gICAgdGhpcy5jZWxsTnVtYmVyID0gY2VsbE51bWJlcjtcclxuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgdGhpcy5zdHlsZSA9IHN0eWxlO1xyXG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgdGhpcy5tZXJnZSA9IG1lcmdlO1xyXG4gICAgdGhpcy5zX2hlaWdodCA9IHNfaGVpZ2h0O1xyXG4gICAgdGhpcy5nZXRDZWxsU3R5bGUoKTtcclxuICAgIHRoaXMuZ2V0Q2VsbFZhbHVlKCk7XHJcbiAgfVxyXG5cclxuICBnZXRDZWxsU3R5bGUoKSB7XHJcbiAgICBjb25zdCB7c3R5bGV9ID0gdGhpcztcclxuICAgIGNvbnN0IHJlc3VsdDogYW55ID0ge307XHJcbiAgICBpZiAoc3R5bGUpIHtcclxuICAgICAgaWYgKHN0eWxlLmZvbnQ/LnNpemUpIHtcclxuICAgICAgICByZXN1bHRbJ2ZvbnQtc2l6ZSddID0gYCR7c3R5bGUuZm9udC5zaXplfXB4YDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3R5bGUuZm9udD8uYm9sZCkge1xyXG4gICAgICAgIHJlc3VsdFsnZm9udC13ZWlnaHQnXSA9ICdib2xkJztcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3R5bGUuZm9udD8uY29sb3I/LmFyZ2IpIHtcclxuICAgICAgICByZXN1bHRbJ2NvbG9yJ10gPSBgIyR7c3R5bGUuZm9udC5jb2xvci5hcmdiLnNsaWNlKC02KX1gO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodHlwZW9mIHRoaXMudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgcmVzdWx0WydqdXN0aWZ5LWNvbnRlbnQnXSA9ICdmbGV4LWVuZCc7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHN0eWxlLmFsaWdubWVudCkge1xyXG4gICAgICAgIGNvbnN0IGFsaWdubWVudDogYW55ID0ge1xyXG4gICAgICAgICAgbWlkZGxlOiAnY2VudGVyJyxcclxuICAgICAgICAgIGNlbnRlcjogJ2NlbnRlcicsXHJcbiAgICAgICAgICB0b3A6ICdmbGV4LXN0YXJ0JyxcclxuICAgICAgICAgIGJvdHRvbTogJ2ZsZXgtZW5kJyxcclxuICAgICAgICAgIGxlZnQ6ICdmbGV4LXN0YXJ0JyxcclxuICAgICAgICAgIHJpZ2h0OiAnZmxleC1lbmQnXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzdHlsZS5hbGlnbm1lbnQudmVydGljYWwpIHtcclxuICAgICAgICAgIHJlc3VsdFsnYWxpZ24taXRlbXMnXSA9IGFsaWdubWVudFtzdHlsZS5hbGlnbm1lbnQudmVydGljYWxdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3R5bGUuYWxpZ25tZW50Lmhvcml6b250YWwpIHtcclxuICAgICAgICAgIHJlc3VsdFsnanVzdGlmeS1jb250ZW50J10gPSBhbGlnbm1lbnRbc3R5bGUuYWxpZ25tZW50Lmhvcml6b250YWxdO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAoc3R5bGUuZmlsbD8uY29sb3I/LmluZGV4ZWQgPCA2NCkge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gKHN0eWxlLmZpbGw/LmNvbG9yPy5pbmRleGVkIHx8IDApLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcmVzdWx0WydiYWNrZ3JvdW5kJ10gPSBpbmRleGNlZENvbG9yc1tpbmRleF07XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHN0eWxlLmZpbGw/LmZnQ29sb3I/LmFyZ2IpIHtcclxuICAgICAgICByZXN1bHRbJ2JhY2tncm91bmQnXSA9IGAjJHtzdHlsZS5maWxsLmZnQ29sb3IuYXJnYi5zbGljZSgtNil9YDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3R5bGUuZmlsbD8uZmdDb2xvcj8udGhlbWUpIHtcclxuICAgICAgICByZXN1bHRbJ2JhY2tncm91bmQnXSA9IHRoaXMuZ2V0VGludENvbG9yKHRoZW1lc1tzdHlsZS5maWxsLmZnQ29sb3IudGhlbWVdLCBzdHlsZS5maWxsLmZnQ29sb3IudGludCB8fCAwKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLm1lcmdlKSB7XHJcbiAgICAgIHJlc3VsdFsnd2lkdGgnXSA9IHRoaXMud2lkdGggKyAncHgnO1xyXG4gICAgICByZXN1bHRbJ2hlaWdodCddID0gdGhpcy5oZWlnaHQgKyAncHgnIHx8ICcxMDAlJztcclxuICAgICAgcmVzdWx0Wyd6LWluZGV4J10gPSAxO1xyXG4gICAgICBpZiAoIXJlc3VsdC5iYWNrZ3JvdW5kKSB7XHJcbiAgICAgICAgcmVzdWx0WydiYWNrZ3JvdW5kJ10gPSAnI2ZmZic7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNlbGxTdHlsZSA9IHJlc3VsdDtcclxuICB9XHJcblxyXG4gIGdldENlbGxWYWx1ZSgpIHtcclxuICAgIGlmICh0eXBlb2YgdGhpcy52YWx1ZSA9PT0gJ29iamVjdCcgJiYgdGhpcy52YWx1ZS5yaWNoVGV4dCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5jZWxsVmFsdWUgPSB0aGlzLnZhbHVlLnJpY2hUZXh0Lm1hcCgoZDogYW55KSA9PiBkLnRleHQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuY2VsbFZhbHVlID0gdGhpcy52YWx1ZTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGludENvbG9yKGhleDpzdHJpbmcsIHRpbnQ6bnVtYmVyKSB7XHJcbiAgICBjb25zdCBzaG9ydGhhbmRSZWdleCA9IC9eIz8oW2EtZlxcZF0pKFthLWZcXGRdKShbYS1mXFxkXSkkL2k7XHJcbiAgICBoZXggPSBoZXgucmVwbGFjZShzaG9ydGhhbmRSZWdleCwgKG0sIHIsIGcsIGIpID0+IHtcclxuICAgICAgcmV0dXJuIHIgKyByICsgZyArIGcgKyBiICsgYjtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHJnYiA9IC9eIz8oW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkkL2kuZXhlYyhoZXgpO1xyXG4gICAgaWYgKCFyZ2IpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBjb25zdCByID0gcGFyc2VJbnQocmdiWzFdLCAxNik7XHJcbiAgICBjb25zdCBnID0gcGFyc2VJbnQocmdiWzJdLCAxNik7XHJcbiAgICBjb25zdCBiID0gcGFyc2VJbnQocmdiWzNdLCAxNik7XHJcblxyXG4gICAgaWYgKHRpbnQgPj0gMCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5yZ2JUb0hleChyICsgKCgyNTUgLSByKSAqIHRpbnQpLCBnICsgKCgyNTUgLSBnKSAqIHRpbnQpLCBiICsgKCgyNTUgLSBiKSAqIHRpbnQpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnJnYlRvSGV4KHIgKiAoMSAtICh0aW50ICogLTEpKSwgZyAqICgxIC0gKHRpbnQgKiAtMSkpLCBiICogKDEgLSAodGludCAqIC0xKSkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZ2JUb0hleChyOm51bWJlciwgZzpudW1iZXIsIGI6bnVtYmVyKSB7XHJcbiAgICByZXR1cm4gXCIjXCIgKyAoKDEgPDwgMjQpICsgKE1hdGgucm91bmQocikgPDwgMTYpICsgKE1hdGgucm91bmQoZykgPDwgOCkgKyBNYXRoLnJvdW5kKGIpKS50b1N0cmluZygxNikuc2xpY2UoMSk7XHJcbiAgfVxyXG5cclxuXHJcbn1cclxuIl19